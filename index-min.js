var oList,PRODUCTLIST;$(document).ready((()=>{$("#neograf-compra").hide(),$("#neograf-compra-prepare").hide(),$.getJSON("model/productList.json",((e,t)=>{"success"==t&&(PRODUCTLIST=e).length>0&&(displayPopUp("navTabContent"),oList=new pedido,checkLocalstorage())})),$("#showShellButton").click((function(e){displayPopUp("dialogShell")}))}));const displayPopUp=e=>{[{navTabContent:navTabContent,dialogShell:dialogShell}][0][e]()},eventClickQuantityProduct=e=>{let t=0;$("#form-cantidad-input").val(""),$("#neograf-compra-title h3").remove(),$("#neograf-compra-title").prepend(`<h3 class="container product-add-title text-center">\n                                            ${e.descripcion}\n                                            </h3>`),$("#div-product-nota p").remove(),$("#div-product-nota").append(`\n                                <p>${e.nota}</p>\n                                `),$("#div-product-image img").remove(),$("#div-product-image").append(`\n                                <img \n                                src="img/${e.archive}" \n                                alt="${e.descripcion}" \n                                style="height: 250px; width: 250px;">\n                                    `),$("#divButton #myButtonAccept").remove(),$("#divButton").append('<Button id="myButtonAccept">COMPRAR</button>'),$("#neograf-compra #myButtonCancelCompra").remove(),$("#neograf-compra").prepend('<button id="myButtonCancelCompra" style="padding:2%" type="button" aria-label="Close"></button>'),$("#myButtonAccept").toggleClass("btn btn-outline-primary"),$("#myButtonCancelCompra").toggleClass("btn-close"),$("#div-calculo-input p:last").change((function(e){e.currentTarget.innerText=t,t>0?$("#myButtonAccept").show():$("#myButtonAccept").hide()})),$("#form-cantidad-input").change((function(a){let n=document.getElementById(a.currentTarget.id);t=parseInt(parseInt(n.value)*parseInt(e.cantidadDesde)),$("#div-calculo-input p").trigger("change")})),$("#myButtonAccept").on("click",(function(t){cargar_producto(e),$("#neograf-compra").hide(),$("#showShellButton").show()})),$("#myButtonCancelCompra").on("click",(function(e){$("#neograf-compra").hide()})),$("#myButtonAccept").hide(),$("#neograf-compra").slideDown("slow")},navTabContent=()=>{let e=0;for(let t of PRODUCTLIST)0==e?($("aside #list-tab:first-child").append(`<a class="list-group-item list-group-item-action active" id="list-${CATEGORIA.find((e=>e.id===t.categoria)).value}-list" data-bs-toggle="list"\n        href="#list-${CATEGORIA.find((e=>e.id===t.categoria)).value}" role="tab" aria-controls="list-${CATEGORIA.find((e=>e.id===t.categoria)).value}-list">${CATEGORIA.find((e=>e.id===t.categoria)).descripcion}</a>`),$("#nav-tabContent").append(`<div class="tab-pane fade show active" id="list-${CATEGORIA.find((e=>e.id===t.categoria)).value}" role="tabpanel"\n        aria-labelledby="list-${CATEGORIA.find((e=>e.id===t.categoria)).value}-list">`)):($("aside #list-tab:first-child").append(`<a class="list-group-item list-group-item-action" id="list-${CATEGORIA.find((e=>e.id===t.categoria)).value}-list" data-bs-toggle="list"\n        href="#list-${CATEGORIA.find((e=>e.id===t.categoria)).value}" role="tab" aria-controls="list-${CATEGORIA.find((e=>e.id===t.categoria)).value}-list">${CATEGORIA.find((e=>e.id===t.categoria)).descripcion}</a>`),$("#nav-tabContent").append(`<div class="tab-pane fade" id="list-${CATEGORIA.find((e=>e.id===t.categoria)).value}" role="tabpanel"\n        aria-labelledby="list-${CATEGORIA.find((e=>e.id===t.categoria)).value}-list">`)),$(`#nav-tabContent #list-${CATEGORIA.find((e=>e.id===t.categoria)).value}`).append(`<div class="row">\n                                <div class="col-11 col-md-4">\n                                <div class="shadow-lg p-3 mb-5 bg-white rounded neograf-product-card animate__animated animate__zoomIn">\n                                <div class="neograf-product-img-card col-12">\n                                    <img src="img/${t.archive}" alt="${CATEGORIA.find((e=>e.id===t.categoria)).descripcion}" class="neograf-imagen-responsive">\n                                </div>\n                                <h5>${t.descripcion}</h5>\n                                <div class="neograf-product-img-card-txt">\n                                    <p class="neograf-fonts">${t.nota}</p>\n                                </div>\n                                <div class="neograf-product-img-price-txt">\n                                    <span>Desde</span>\n                                    <span class="neograf-product-price">$${t.precioDesde}</span>\n                                    <span class="neograf-product-quantity"> + IVA</span>\n                                    <span class="neograf-product-quantity"> /${t.cantidadDesde} ${t.medicionDesde}</span>\n                                    <span>\n                                    <button class="neograf-button-span" type="button" id="add_quanty_product_${t.id}">\n                                        <i class="fas fa-shopping-cart"></i>\n                                    </button>\n                                    </span>\n                                </div>\n                                </div>\n                                </div>\n                            </div>\n                            </div>`),$(`#add_quanty_product_${t.id}`).on("click",(function(){eventClickQuantityProduct(t)})),e++},dialogShell=()=>{if(oList){const e=oList.get_pedido();let t=new Date;$("#section-header-nc-notes p:nth-child(2)").remove(),$("#section-header-nc-notes").append(`\n                                        <p class="col-8">${t.toLocaleString()}</p>   \n                                            `),$("#headerTable th").remove();for(let e in MYOUTPUT)$("#headerTable").append(`\n                                    <th>\n                                        ${MYOUTPUT[e]}\n                                    </th>\n            `);$("table tbody tr").remove();for(let t=0;t<e.length;t++){$("table tbody").append(`\n                                    <tr id="bodyTable_${t}">\n                                    </tr>\n                                    `);for(let a in e[t]){let n=document.getElementById(`input-${a}-Resumen`);null!==n&&(n.innerText=(parseFloat(n.innerText)+parseFloat(e[t][a])).toFixed(2)),a in MYOUTPUT&&$(`table tbody tr:nth-child(${t+1})`).append(`\n                                                            <td>\n                                                                ${e[t][a]}\n                                                            </td>\n                    `)}}const a=$("#neograf-compra-prepare button");let n={myButtonCancelPedido:function(e){$("#neograf-compra-prepare").hide()},myButtonConfirm:function(e){alert("¡Felicidades a adquirido correctamente los productos!"),e.view.oList.delete_pedido(),$("#neograf-compra-prepare").hide(),document.getElementById("labelSpanHeaderProduct").innerText="Productos agregados a tu compra: 0",$("#showShellButton").hide()},myButtonDelete:function(e){confirm("¿Esta seguro de Eliminar esta compra?. Su pedido se borrara completamente del sistema")&&(e.view.oList.delete_pedido(),$("#neograf-compra-prepare").hide(),document.getElementById("labelSpanHeaderProduct").innerText="Productos agregados a tu compra: 0",$("#showShellButton").hide())},myButtonSave:function(e){let t=localStorage,a=JSON.stringify(e.view.oList.get_pedido());t.setItem(`pedido_${localStorage.length+1}`,a),$("#neograf-compra-prepare").hide()}};a.click((e=>{e.view.oList.get_pedido().length>0&&n[e.currentTarget.id](e)})),$("#neograf-compra-prepare").slideDown("slow")}},checkLocalstorage=()=>{let e,t;localStorage.length>0&&setTimeout((()=>{if(confirm("Existe un pedido guardado. ¿Desea seguir su tratamiento?")){for(t=0;!e;)e=localStorage.getItem(`pedido_${localStorage.length}`),t++;let a=JSON.parse(e);oList.oStore(a),document.getElementById("labelSpanHeaderProduct").innerText=`Productos agregados a tu compra: ${oList.get_pedido().length}`,$("#showShellButton").show()}}),1e3)},cargar_producto=function(e){oList.process_pedido(e),oList.change_label_header()};